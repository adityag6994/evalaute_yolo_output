Image ../data/samples/COCO_val2014_000000000285.jpg:
	+ Label: bear | Confidence: 0.9492
	[top-left bottom-right in image size]
	[[ 14.372324    77.52951    563.3389     624.37964      0.94917077    21.        ]]

    key :  21
    0 [38.54919587648832, 58.32381028395433, 534.5834253017719, 612.3077627328726]
=======================================================================================

Image ../data/samples/COCO_val2014_000000000757.jpg:
	+ Label: elephant | Confidence: 0.9995
	[[ 75.91327    28.07202   574.53564   414.9989      0.9995191  20.       ]]

	key :  20
    0 [75.91327373798077, 89.55381793242235, 574.5356633112981, 347.706564279703]
    1 [346.88754    200.16357    142.91997    277.75577      0.50287074]
=======================================================================================

Image ../data/samples/COCO_val2014_000000001955.jpg:
	+ Label: person | Confidence: 0.9988
	+ Label: kite | Confidence: 0.8476
	[[110.41246   458.847     208.02284   638.6111      0.9987842   0.       ]
     [152.53596   120.37948   404.2513    334.77463     0.8476475  33.       ]]

    key :  0
    0 [144.4903322137319, 458.84695199819714, 209.6147535259907, 638.611074594351]
    key :  33
    0 [172.59459974215582, 120.37947434645433, 340.5359322291154, 334.77461594801684]
=======================================================================================


Image ../data/samples/COCO_val2014_000000002149.jpg:
	+ Label: apple | Confidence: 0.9390
	+ Label: apple | Confidence: 0.8725
	+ Label: bowl | Confidence: 0.8709
	+ Label: apple | Confidence: 0.5020
	[[8.8534767e+01 8.9508430e+01 3.3699622e+02 3.1435443e+02 9.3907672e-01   4.7000000e+01]
     [3.3296341e+02 7.5513039e+01 5.9227380e+02 3.3860199e+02 8.7269533e-01   4.7000000e+01]
     [3.7549698e+01 8.1293221e+01 6.0559576e+02 4.4453860e+02 8.7089986e-01   4.5000000e+01]
     [2.4625885e+02 2.9899640e+02 4.2651779e+02 3.9982892e+02 5.0188059e-01   4.7000000e+01]]

    key :  47
    0 [88.53476891150841, 130.54341853581943, 336.9962369478666, 280.55787722881024]
    1 [332.963385948768, 121.20587273744437, 592.2738060584435, 296.7355107710912]
    2 [218.65242   296.11823   117.168335   65.54115     0.5113727]
    key :  45
    0 [37.54969670222356, 125.06233783868643, 605.5958205003005, 367.41511487960815]

=======================================================================================
Image ../data/samples/COCO_val2014_000000002164.jpg:
	+ Label: sheep | Confidence: 0.9823
	+ Label: sheep | Confidence: 0.9686
	+ Label: sheep | Confidence: 0.9666
	+ Label: sheep | Confidence: 0.9645
	+ Label: sheep | Confidence: 0.9629
	+ Label: sheep | Confidence: 0.9506
	+ Label: sheep | Confidence: 0.9409
	+ Label: sheep | Confidence: 0.9381
	+ Label: sheep | Confidence: 0.9238
	+ Label: sheep | Confidence: 0.8444
	+ Label: sheep | Confidence: 0.8414
	+ Label: sheep | Confidence: 0.7431
	+ Label: sheep | Confidence: 0.7311
	+ Label: sheep | Confidence: 0.6462
	[[380.08942    285.46356    415.0954     322.8805       0.98230726    18.        ]
 [281.0896     283.5848     318.55414    312.58926      0.96855533    18.        ]
 [584.27167    263.6749     606.67914    280.15308      0.9666325   18.        ]
 [333.752      286.50607    364.797      317.02817      0.96448684    18.        ]
 [231.05486    276.3352     257.5042     301.1388       0.9629062    18.        ]
 [314.9598     285.05154    339.54504    317.0504       0.9506117    18.        ]
 [184.65547    277.21094    199.75656    300.2637       0.9409298    18.        ]
 [290.70193    259.25162    306.52353    270.0143       0.9380561    18.        ]
 [ 83.539345   255.36472     96.654274   264.08792      0.92379016    18.        ]
 [106.09096    251.46744    118.95822    260.97348      0.8444039    18.        ]
 [134.59074    252.88818    145.68018    260.50415      0.8414252    18.        ]
 [163.64142    250.2732     172.69183    256.65143      0.7430485    18.        ]
 [171.8649     251.68048    184.48972    258.90753      0.73102456    18.        ]
 [285.93677    256.88824    298.6339     265.3792       0.6462262    18.        ]]

    0 [380.08941650390625, 260.05843510994544, 415.09537916917066, 284.90562530664295]
    1 [281.0895875784067, 258.81081687716335, 318.5541549095741, 278.0715799675538]
    2 [584.2716613182655, 245.5894005126678, 606.6791725158691, 256.53194713477905]
    3 [231.05485329261194, 253.9966369477602, 257.504200568566, 270.4677612162553]
    4 [333.7520247239333, 260.75071703929166, 364.79698181152344, 281.01930102476706]
    5 [314.95980776273285, 259.784822509839, 339.54505626971905, 281.0340851545334]
    6 [184.65547708364633, 254.57816992241604, 199.7565665611854, 269.8866647309982]
    7 [290.70194831261267, 242.65206288546324, 306.5235343346229, 249.79917391274984]
    8 [83.53934874901405, 240.0709176579347, 96.65427354665903, 245.86365712949862]
    9 [134.590739103464, 238.42634178984625, 145.68016309004562, 243.4838319197297]
    10 [106.09095059908353, 237.4828860306969, 118.9582296518179, 243.79550045212875]
    11 [163.64142087789682, 236.68984471318814, 172.69184516026422, 240.92536684698783]
    12 [171.86489838820236, 237.62436340061518, 184.4897064795861, 242.42355946737987]
    13 [189.98547   238.73692     8.253137    5.5191374   0.6536316]

=======================================================================================

Image ../data/samples/COCO_val2014_000000002759.jpg:
	+ Label: bowl | Confidence: 0.9953
	+ Label: bowl | Confidence: 0.9941
	+ Label: spoon | Confidence: 0.9603
	+ Label: diningtable | Confidence: 0.7210
	+ Label: broccoli | Confidence: 0.6460
	+ Label: broccoli | Confidence: 0.6284
	[[4.8355336e+00 1.1445433e+02 3.4834213e+02 3.9818472e+02 9.9526477e-01   4.5000000e+01]
     [2.5914761e+02 6.2286730e+00 6.1723059e+02 2.3159085e+02 9.9411112e-01   4.5000000e+01]
     [4.0024536e+02 2.9578436e+02 6.3521082e+02 4.0229050e+02 9.6029323e-01   4.4000000e+01]
     [3.1307772e+01 1.6519470e+01 6.1773950e+02 4.1893649e+02 7.2100574e-01   6.0000000e+01]
     [1.3532690e+02 3.1754962e+02 1.7839105e+02 3.3973761e+02 6.4621437e-01   5.0000000e+01]
     [2.3853796e+01 2.7269064e+02 8.1066475e+01 3.2056430e+02 6.2837076e-01   5.0000000e+01]]

    key :  44
    0 [400.24537306565503, 267.54009532928467, 635.2107943021334, 338.43328923445483]
    key :  45
    0 [4.835533728966346, 146.84231207920953, 348.3421443058894, 335.7003740897545]
    1 [259.14759709284857, 74.80461425047655, 617.2305767352765, 224.8113264303941]
    key :  60
    0 [210.94037   210.5232    381.18063   261.57108     0.7212807]
    key :  50
    0 [135.32690048217773, 282.02761895381485, 178.39105606079102, 296.7964959190442]
    1 [23.853794978215145, 252.1683627137771, 81.06647198016827, 284.0342763524789]

=======================================================================================

Image ../data/samples/COCO_val2014_000000004229.jpg:
	+ Label: elephant | Confidence: 0.7780
	+ Label: elephant | Confidence: 0.6984
	+ Label: elephant | Confidence: 0.5601
	+ Label: elephant | Confidence: 0.5426
 	[[6.0850073e+02 1.1516416e+02 6.4044220e+02 1.6915442e+02 7.7797753e-01   2.0000000e+01]
     [2.7865469e+02 1.0443308e+02 4.2573764e+02 2.9775745e+02 6.9837040e-01   2.0000000e+01]
     [3.0958792e+02 1.9040549e+02 6.4018500e+02 3.4871066e+02 5.5988288e-01   2.0000000e+01]
     [7.3435982e+01 1.3358203e+02 3.1156024e+02 3.4986288e+02 5.4269069e-01  2.0000000e+01]]

    key :  20
    0 [72.59722196138821, 153.96985450157752, 332.90645892803485, 297.9952347095196]
    1 [276.28504239595856, 142.5082038457577, 429.4702911376953, 265.0148904782075]
    2 [309.58791879507214, 197.8606746471845, 640.1850304236779, 303.4798981501506]
    3 [608.5007344759427, 147.66060404594128, 640.4422305180476, 183.68222763905158]


+-------+-------------+---------+
| Index | Class       | AP      |
+-------+-------------+---------+
| 0     | person      | 1.00000 |
| 2     | car         | 0.50000 |
| 18    | sheep       | 0.70139 |
| 20    | elephant    | 0.85714 |
| 21    | bear        | 1.00000 |
| 33    | kite        | 1.00000 |
| 44    | spoon       | 1.00000 |
| 45    | bowl        | 1.00000 |
| 47    | apple       | 1.00000 |
| 50    | broccoli    | 0.60522 |
| 60    | diningtable | 1.00000 |
+-------+-------------+---------+
---- mAP 0.87852 ----

+===================+=================++===================+=================++===================+=================+
+= Jan 24 * ========+=================++===================+=================++===================+=================+
+===================+=================++===================+=================++===================+=================+


+-----+-----+-----+
285.npy
0  | class :  21 [38.54919587648832, 58.32381028395433, 534.5834253017719, 612.3077627328726]
+-----+-----+-----+
757.npy
0  | class :  20 [75.91327373798077, 89.55381793242235, 574.5356633112981, 347.706564279703]
1  | class :  20 [346.88754    200.16357    142.91997    277.75577      0.50287074]
+-----+-----+-----+
1955.npy
0  | class :  0 [144.4903322137319, 458.84695199819714, 209.6147535259907, 638.611074594351]
0  | class :  33 [172.59459974215582, 120.37947434645433, 340.5359322291154, 334.77461594801684]
+-----+-----+-----+
2149.npy
0  | class :  47 [88.53476891150841, 130.54341853581943, 336.9962369478666, 280.55787722881024]
1  | class :  47 [332.963385948768, 121.20587273744437, 592.2738060584435, 296.7355107710912]
2  | class :  47 [218.65242   296.11823   117.168335   65.54115     0.5113727]
0  | class :  45 [37.54969670222356, 125.06233783868643, 605.5958205003005, 367.41511487960815]
+-----+-----+-----+
2164.npy
0  | class :  18 [380.08941650390625, 260.05843510994544, 415.09537916917066, 284.90562530664295]
1  | class :  18 [281.0895875784067, 258.81081687716335, 318.5541549095741, 278.0715799675538]
2  | class :  18 [584.2716613182655, 245.5894005126678, 606.6791725158691, 256.53194713477905]
3  | class :  18 [231.05485329261194, 253.9966369477602, 257.504200568566, 270.4677612162553]
4  | class :  18 [333.7520247239333, 260.75071703929166, 364.79698181152344, 281.01930102476706]
5  | class :  18 [314.95980776273285, 259.784822509839, 339.54505626971905, 281.0340851545334]
6  | class :  18 [184.65547708364633, 254.57816992241604, 199.7565665611854, 269.8866647309982]
7  | class :  18 [290.70194831261267, 242.65206288546324, 306.5235343346229, 249.79917391274984]
8  | class :  18 [83.53934874901405, 240.0709176579347, 96.65427354665903, 245.86365712949862]
9  | class :  18 [134.590739103464, 238.42634178984625, 145.68016309004562, 243.4838319197297]
10  | class :  18 [106.09095059908353, 237.4828860306969, 118.9582296518179, 243.79550045212875]
11  | class :  18 [163.64142087789682, 236.68984471318814, 172.69184516026422, 240.92536684698783]
12  | class :  18 [171.86489838820236, 237.62436340061518, 184.4897064795861, 242.42355946737987]
13  | class :  18 [189.98547   238.73692     8.253137    5.5191374   0.6536316]
+-----+-----+-----+
2759.npy
0  | class :  44 [400.24537306565503, 267.54009532928467, 635.2107943021334, 338.43328923445483]
0  | class :  45 [4.835533728966346, 146.84231207920953, 348.3421443058894, 335.7003740897545]
1  | class :  45 [259.14759709284857, 74.80461425047655, 617.2305767352765, 224.8113264303941]
0  | class :  60 [210.94037   210.5232    381.18063   261.57108     0.7212807]
0  | class :  50 [135.32690048217773, 282.02761895381485, 178.39105606079102, 296.7964959190442]
1  | class :  50 [23.853794978215145, 252.1683627137771, 81.06647198016827, 284.0342763524789]
+-----+-----+-----+
4229.npy
0  | class :  20 [72.59722196138821, 153.96985450157752, 332.90645892803485, 297.9952347095196]
1  | class :  20 [276.28504239595856, 142.5082038457577, 429.4702911376953, 265.0148904782075]
2  | class :  20 [309.58791879507214, 197.8606746471845, 640.1850304236779, 303.4798981501506]
3  | class :  20 [608.5007344759427, 147.66060404594128, 640.4422305180476, 183.68222763905158]
Done!

Process finished with exit code 0


added 2 new images, to have same classes in multiple images
+-------+-------------+---------+
| Index | Class       | AP      |
+-------+-------------+---------+
| 0     | person      | 0.84821 |
| 2     | car         | 0.50000 |
| 18    | sheep       | 0.70139 |
| 20    | elephant    | 0.85714 |
| 21    | bear        | 1.00000 |
| 31    | snowboard   | 1.00000 |
| 33    | kite        | 1.00000 |
| 36    | skateboard  | 1.00000 |
| 44    | spoon       | 1.00000 |
| 45    | bowl        | 1.00000 |
| 47    | apple       | 1.00000 |
| 50    | broccoli    | 0.60522 |
| 60    | diningtable | 1.00000 |
+-------+-------------+---------+

/home/gabbar/Desktop/naukri_2022/code/venv/bin/python /home/gabbar/Desktop/naukri_2022/code/yolo_postprocessing/extract_boxes/get_predictions.py
+-----+------+-----+
285.npy
0  | class :  21 [[38.54919587648832, 58.32381028395433, 534.5834253017719, 612.3077627328726], 0.99608684]
+-----+------+-----+
757.npy
0  | class :  20 [[75.91327373798077, 89.55381793242235, 574.5356633112981, 347.706564279703], 0.99997735]
1  | class :  20 [346.88754    200.16357    142.91997    277.75577      0.50287074]
+-----+------+-----+
831.npy
0  | class :  0 [[153.20687820361212, 101.4856008382944, 241.64589560948886, 268.7364541567289], 0.9998266]
1  | class :  0 [309.46127   221.8923      7.790184   21.858944    0.7291201]
0  | class :  36 [[145.63755545249353, 236.87487611403833, 207.19557215617255, 307.73191956373364], 0.993455]
+-----+------+-----+
836.npy
0  | class :  31 [[188.12248340019812, 81.87453347903032, 301.2327872789823, 144.970910686713], 0.84001714]
0  | class :  0 [[204.49047822218674, 100.72604747918936, 286.1345731295072, 169.71848762952365], 0.91867006]
+-----+------+-----+
1955.npy
0  | class :  0 [[144.4903322137319, 458.84695199819714, 209.6147535259907, 638.611074594351], 0.9987974]
0  | class :  33 [[172.59459974215582, 120.37947434645433, 340.5359322291154, 334.77461594801684], 0.8486494]
+-----+------+-----+
2149.npy
0  | class :  47 [[88.53476891150841, 130.54341853581943, 336.9962369478666, 280.55787722881024], 0.9413483]
1  | class :  47 [[332.963385948768, 121.20587273744437, 592.2738060584435, 296.7355107710912], 0.8775574]
2  | class :  47 [218.65242   296.11823   117.168335   65.54115     0.5113727]
0  | class :  45 [[37.54969670222356, 125.06233783868643, 605.5958205003005, 367.41511487960815], 0.98780686]
+-----+------+-----+
2164.npy
0  | class :  18 [[380.08941650390625, 260.05843510994544, 415.09537916917066, 284.90562530664295], 0.98973304]
1  | class :  18 [[281.0895875784067, 258.81081687716335, 318.5541549095741, 278.0715799675538], 0.9752582]
2  | class :  18 [[584.2716613182655, 245.5894005126678, 606.6791725158691, 256.53194713477905], 0.973764]
3  | class :  18 [[231.05485329261194, 253.9966369477602, 257.504200568566, 270.4677612162553], 0.96848494]
4  | class :  18 [[333.7520247239333, 260.75071703929166, 364.79698181152344, 281.01930102476706], 0.9680554]
5  | class :  18 [[314.95980776273285, 259.784822509839, 339.54505626971905, 281.0340851545334], 0.95349175]
6  | class :  18 [[184.65547708364633, 254.57816992241604, 199.7565665611854, 269.8866647309982], 0.95083976]
7  | class :  18 [[290.70194831261267, 242.65206288546324, 306.5235343346229, 249.79917391274984], 0.9431206]
8  | class :  18 [[83.53934874901405, 240.0709176579347, 96.65427354665903, 245.86365712949862], 0.93408173]
9  | class :  18 [[134.590739103464, 238.42634178984625, 145.68016309004562, 243.4838319197297], 0.863916]
10  | class :  18 [[106.09095059908353, 237.4828860306969, 118.9582296518179, 243.79550045212875], 0.85491735]
11  | class :  18 [[163.64142087789682, 236.68984471318814, 172.69184516026422, 240.92536684698783], 0.7547811]
12  | class :  18 [[171.86489838820236, 237.62436340061518, 184.4897064795861, 242.42355946737987], 0.73931926]
13  | class :  18 [189.98547   238.73692     8.253137    5.5191374   0.6536316]
+-----+------+-----+
2759.npy
0  | class :  44 [[400.24537306565503, 267.54009532928467, 635.2107943021334, 338.43328923445483], 0.98990494]
0  | class :  45 [[4.835533728966346, 146.84231207920953, 348.3421443058894, 335.7003740897545], 0.9989336]
1  | class :  45 [[259.14759709284857, 74.80461425047655, 617.2305767352765, 224.8113264303941], 0.99785656]
0  | class :  60 [210.94037   210.5232    381.18063   261.57108     0.7212807]
0  | class :  50 [[135.32690048217773, 282.02761895381485, 178.39105606079102, 296.7964959190442], 0.64654887]
1  | class :  50 [[23.853794978215145, 252.1683627137771, 81.06647198016827, 284.0342763524789], 0.6285219]
+-----+------+-----+
4229.npy
0  | class :  20 [[72.59722196138821, 153.96985450157752, 332.90645892803485, 297.9952347095196], 0.9966079]
1  | class :  20 [[276.28504239595856, 142.5082038457577, 429.4702911376953, 265.0148904782075], 0.93357176]
2  | class :  20 [[309.58791879507214, 197.8606746471845, 640.1850304236779, 303.4798981501506], 0.8822038]
3  | class :  20 [[608.5007344759427, 147.66060404594128, 640.4422305180476, 183.68222763905158], 0.7802893]
Done!

Process finished with exit code 0
